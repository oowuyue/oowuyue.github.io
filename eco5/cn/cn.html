<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%">

<head>
    <meta charset="utf-8" />
</head>

<body style="height: 100%; width: 100%; margin: 0">
    <div id="container" style="height: 100%; "></div>
    <script type="text/javascript" src="./data/CPI,PPI,CPI_PPI.js"></script>
    <script type="text/javascript" src="./data/财新制造业PMI,官方制造业PMI.js"></script>
    <script type="text/javascript" src="./data/利润同比,亏损增减.js"></script>
    <script type="text/javascript" src="./data/股债差300平均.js"></script>
    <script type="text/javascript" src="./data/股300pe.js"></script>
    <script type="text/javascript" src="./data/MSCI中国指数,MSCI中国收益率.js"></script>
    <script type="text/javascript" src="../us/data/Y10.js"></script>
    <script type="text/javascript" src="./data/沪深300PE中位数,全A股PE中位数,十年期国债利率倒数.js"></script>
    <script type="text/javascript" src="data/沪深300同比,上证同比.js"></script>
    <script type="text/javascript" src="./data/M1,M1_M2.js"></script>
    <script type="text/javascript" src="./data/信贷脉冲,房价同比,沪深300Day.js"></script>
    <script type="text/javascript">
        CPI = CPI.filter(item => {
            return parseFloat(item[0].substring(0, 4)) >= 2000
        })
        PPI = PPI.filter(item => {
            return parseFloat(item[0].substring(0, 4)) >= 2000
        })

        let MA = 4 //https://www.jianshu.com/p/d709fe2be814
        let PPI_MA = PPI.map((item, index) => {
            const copyItem = [...item];
            if (index < MA) {
                return copyItem
            }

            let sum = 0
            for (let i = index - MA; i < index; i++) {
                sum += parseFloat(PPI[i][1])
            }
            let avg = (sum / MA).toFixed(2)

            copyItem[1] = avg
            return copyItem
        })


        function findSameTime(array, time) {
            for (let index = 0; index < array.length; index++) {
                const element = array[index];
                if (element[0] == time) return parseFloat(element[1])
            }
            return null
        }
        官方制造业PMI = 官方制造业PMI.map(item => {
            item[1] = parseFloat(((item[1] - 50) * 1).toFixed(2))
            return item
        })
        财新制造业PMI = 财新制造业PMI.map(item => {
            item[1] = parseFloat(((item[1] - 50) * 1).toFixed(2))
            return item
        })
        let cn_pmi_平均 = 官方制造业PMI.map((item, index) => {
            let newArr = []
            newArr[0] = item[0]
            let avg
            let cx = findSameTime(财新制造业PMI, item[0])
            if (cx) avg = (item[1] * 0.5 + cx * 0.5).toFixed(2)
            else avg = item[1].toFixed(2)
            newArr[1] = parseFloat(avg)
            return newArr
        }).filter(item => {
            return true //parseFloat(item[0].substring(0, 4)) >= 2008
        })


        // let 股债差300平均美债 = 沪深300pe.map((item) => {
        //     let date = new Date(item.ts)  
        //     Y = date.getFullYear() + '-'
        //     M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-'
        //     D = date.getDate() < 10 ? '0' + date.getDate() : date.getDate()
        //     date = Y + M + D

        //     let findY10 = Y10.find(element => {
        //         return element[0] == date
        //     })

        //     if (findY10)
        //         return [date, parseFloat(findY10[1]) - (1 / item.pe) ]
        //     else
        //         return [date, ""]
        // })

        // // let 股债差MSCI中国美债 = MSCI中国收益率.map((item) => {
        // //     let findY10 = Y10.find(element => {
        // //         return element[0] == item[0]
        // //     })
        // //     if (findY10)
        // //         return [item[0], parseFloat(findY10[1]) - parseFloat(item[1])  ]
        // //     else
        // //         return [item[0], ""]
        // // })
       


        M1 = M1.map(((item, index, arr) => {
            if (item[0].includes("01-28")) {
                let pre = M1[index - 1]
                let next = M1[index + 1]
                pre = pre ? parseFloat(pre[1]) : 0
                next = next ? parseFloat(next[1]) : 0
                if ((pre * next) != 0)
                    item[1] = (pre + next) / 2
                else
                    item[1] = (pre + next)
            }
            return item
        }))
        let M1_MA = M1.map((item, index) => {
            const copyItem = [...item];
            if (index < MA) {
                //item[1]=0
                return copyItem
            }

            let sum = 0
            for (let i = index - MA; i < index; i++) {
                sum += parseFloat(M1[i][1])
            }
            let avg = (sum / MA).toFixed(2)

            copyItem[1] = avg
            return copyItem
        })

        let 信贷脉冲_MA = 信贷脉冲.map((item, index) => {
            const copyItem = [...item];
            if (index < MA) {
                return copyItem
            }

            let sum = 0
            for (let i = index - MA; i < index; i++) {
                sum += parseFloat(信贷脉冲[i][1])
            }
            let avg = (sum / MA).toFixed(2)

            copyItem[1] = avg
            return copyItem
        })
    </script>
    <script type="text/javascript" src="data/雪球行情/沪深300_xueqiu_day.js"></script>
    <script type="text/javascript" src="data/雪球行情/上证指数_xueqiu_day.js"></script>
    <script>
        function xueqiuFormatDate(stamp, period = "month") {
            var date = new Date(stamp);
            var y = date.getFullYear(),
                m = date.getMonth() + 1,
                d = date.getDate();
            if (m < 10)
                m = '0' + m;
            if (d < 10)
                d = '0' + d;

            if (period == "month") {
                var current_date = new Date();
                var current_y = current_date.getFullYear(),
                    current_m = current_date.getMonth() + 1,
                    current_d = current_date.getDate();
                if (current_m < 10)
                    current_m = '0' + current_m;
                if (current_d < 10)
                    current_d = '0' + current_d;

                if ((y + '-' + m) == (current_y + '-' + current_m)) { //当月不处理
                    var t = y + '-' + m + '-' + d;
                } else {
                    var t = y + '-' + m + '-28';
                }
            }

            if (period == "day") {
                var t = y + '-' + m + '-' + d;
            }


            return t;
        }

        function sectorIndexToObj(ele, period = "month") {
            let newItem = {}
            newItem.stamp = ele[0]
            newItem.date = xueqiuFormatDate(ele[0], period)
            newItem.open = ele[2] //open
            newItem.close = ele[5] //close
            return newItem
        }

        function sectorIndexYoY(ele, index, datasArr) {

            const preItem = datasArr.find(element => {
                let preYear = '' + (parseInt(ele.date.slice(0, 4)) - 1) + ele.date.substring(4, 10)
                return element.date == preYear
            })
            if (preItem) {
                let openYoY = (ele.open - preItem.open) / preItem.open
                let closeYoY = (ele.close - preItem.close) / preItem.close
                let highYoY = (ele.high - preItem.high) / preItem.high
                let lowYoY = (ele.low - preItem.low) / preItem.low
                ele.openYoY = openYoY
                ele.closeYoY = closeYoY
                ele.highYoY = highYoY
                ele.lowYoY = lowYoY
            } else {
                ele.openYoY = ""
                ele.closeYoY = ""
                ele.highYoY = ""
                ele.lowYoY = ""
            }
            return ele

        }

        沪深300_xueqiu_day = 沪深300_xueqiu_day.data.item.map((ele) => {
            return sectorIndexToObj(ele, "day")
        })
        
    </script>
    <script type="text/javascript" src="data/中证行情/科技龙头_csi_day.js"></script>
    <script>
        function csiDayToMonth(csi_day) {
            return csi_day.data
                .filter((ele, index, datasArr) => {
                    currentMonth = ele.tradeDate.substring(4, 6)
                    if (index < datasArr.length - 1) {
                        nextMonth = datasArr[index + 1].tradeDate.substring(4, 6)
                        return currentMonth != nextMonth
                    } else {
                        return true
                    }
                })
                .map((ele, index, datasArr) => {
                    let newEle = {}
                    if (index == datasArr.length - 1)
                        newEle.date = ele.tradeDate.substring(0, 4) + "-" + ele.tradeDate.substring(4, 6) + "-" + ele.tradeDate.substring(6, 8)
                    else
                        newEle.date = ele.tradeDate.substring(0, 4) + "-" + ele.tradeDate.substring(4, 6) + "-28"
                    newEle.close = ele.close
                    newEle.pe = ele.peg

                    let monthFirst = csi_day.data.find(element => {
                        return element.tradeDate.substring(0, 6) == ele.tradeDate.substring(0, 6)
                    })
                    newEle.open = monthFirst.open

                    let sameMonthTenDebt = 十年期国债利率倒数.find(ele => ele[0] == newEle.date)
                    if (sameMonthTenDebt && newEle.pe) {
                        newEle.tenDebt = sameMonthTenDebt ? sameMonthTenDebt[1] : ""
                        newEle.ebys = 1 / newEle.pe - 1 / newEle.tenDebt //Equity and bond yield spreads
                    }
                    return newEle
                })
                .map((ele, index, datasArr) => {

                    let preYear = '' + (parseInt(ele.date.slice(0, 4)) - 1) + ele.date.substring(4, 10)
                    let preItem = datasArr.find(element => {
                        return element.date == preYear
                    })
                    if (!preItem) { //当月去原始数据找
                        preYear = '' + (parseInt(ele.date.slice(0, 4)) - 1) + ele.date.substring(5, 7) + ele.date.substring(8, 10)
                        preItem = csi_day.data.find(element => {
                            return element.tradeDate == preYear
                        })
                    }

                    if (preItem) {
                        let openYoY = preItem.open ? (ele.open - preItem.open) / preItem.open : ""
                        let closeYoY = preItem.close ? (ele.close - preItem.close) / preItem.close : ""
                        ele.openYoY = openYoY
                        ele.closeYoY = closeYoY
                    } else {
                        ele.openYoY = ""
                        ele.closeYoY = ""
                    }
                    return ele
                })
        }
        let 科技龙头_csi_month = csiDayToMonth(科技龙头_csi_day)
    </script>

    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.2/echarts.min.js"></script>
    <script type="text/javascript">
        ////仅为了对齐时间
        Array.prototype.addStartEnd = function (start, end) {
            let arr = this;
            arr = start.concat(arr);
            end.forEach((item) => {
                arr.push(item);
            });
            return arr;
        };
        let currentDay = new Date()
        currentDay = currentDay.getFullYear() + "-" + (currentDay.getMonth() + 1) + "-" + currentDay.getDate()

        let justForAlignmentTime = PPI.map((item) => {
            let newItem = []
            newItem[0] = item[0]
            newItem[1] = 0
            return newItem
        }).addStartEnd([], [
            [currentDay, ""]
        ])
        ////仅为了对齐时间

        var dom = document.getElementById("container");
        var myChart = echarts.init(dom, "red", {
            renderer: "canvas",
            useDirtyRect: false,
        });
        var app = {};
        var option;


        option = {
            title: {},
            tooltip: {
                trigger: "axis",
                show: true,
                position: ["7%", "23.5%"],
                order: "seriesDesc",
                formatter: function (params, ticket, callback) {
                    return null;
                },
                axisPointer: {
                    type: "cross",
                    show: true,
                    crossStyle: {
                        width: 1,
                        color: "black", // 鼠标十字横轴
                    },
                },
            },
            legend: {
                inactiveColor: '#9a9393',
                left: "3.5%",

            },
            axisPointer: {
                type: "cross",
                show: true,
                link: [{
                    xAxisIndex: "all",
                },],
                lineStyle: {
                    color: "black", // 鼠标十字竖轴
                },
            },
            dataZoom: [{
                show: true,
                realtime: true,
                start: 0,
                end: 100,
                xAxisIndex: [0, 1, 2, 3, 4, 5],
                bottom: -15,
            },
            {
                type: "inside",
                realtime: true,
                start: 0,
                end: 100,
                xAxisIndex: [0, 1, 2, 3, 4, 5],
            },
            ],

            grid: [

                { //ppi  cpi
                    left: 60,
                    right: 80,
                    top: "0%",
                    height: '17%',
                    show: true,
                    backgroundColor: '#fafffd',
                },

                { //pmi 利润亏损
                    left: 60,
                    right: 80,
                    top: "17%",
                    height: '18%',
                    show: true,
                    backgroundColor: '#fafffd',
                },

                { //hs300
                    left: 60,
                    right: 80,
                    top: "35.5%",
                    height: '45.5%',
                    show: true,
                    backgroundColor: '#fafffd' //'#e8e8e8',
                },
                { //平均股债
                    left: 60,
                    right: 80,
                    top: "35.5%",
                    height: '20%',
                    show: true,
                    backgroundColor: '#fafffd',
                },
                { //中位股债
                    left: 60,
                    right: 80,
                    top: "55.5%",
                    height: '25.5%',
                    show: true,
                    backgroundColor: '#fafffd',
                },


                { //M1 M1-M2 信贷
                    left: 60,
                    right: 80,
                    top: "81.5%",
                    height: '17%',
                    show: true,
                    backgroundColor: '#fafffd',
                },

            ],

            xAxis: [
                { //ppi  cpi
                    gridIndex: 0,
                    type: "time",
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            //color: ['#aaa']
                        }
                    },
                    axisPointer: {
                        show: true,
                        label: {
                            show: true,
                        },
                    },
                    axisLabel: {
                        fontSize: 10,
                        formatter: "{yyyy}",
                        padding: [0, -50, 0, 0],
                    },

                },

                { //pmi 利润亏损
                    gridIndex: 1,
                    type: "time",
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#bdbdbd']
                        }
                    },
                    axisPointer: {
                        show: true,
                        label: {
                            show: false,
                        },
                    },
                    axisLabel: {
                        show: false
                    }
                },


                { //hs300
                    gridIndex: 2,
                    type: 'time',
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#bdbdbd']
                        }
                    },
                    axisPointer: {
                        show: false,  // 抓数据圆圈
                        label: {
                            show: true,
                        },
                    },
                    axisLabel: {
                        show: false
                    }
                },

                { //
                    gridIndex: 3,
                    type: 'time',
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#bdbdbd']
                        }
                    },
                    axisPointer: {
                        show: true,
                        label: {
                            show: false,
                        },
                    },
                    axisLabel: {
                        show: false
                    }
                },

                { //
                    gridIndex: 4,
                    type: 'time',
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#bdbdbd']
                        }
                    },
                    axisPointer: {
                        show: true,
                        label: {
                            show: false,
                        },
                    },
                    axisLabel: {
                        show: false
                    }
                },

                { //M1 M1-M2 信贷
                    gridIndex: 5,
                    type: "time",
                    splitNumber: 20,
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: ['#bdbdbd']
                        }
                    },
                    axisPointer: {
                        show: true,
                        label: {
                            show: false,
                        },
                    },
                    axisLabel: {
                        show: false
                    }
                },

            ],

            yAxis: [
                { //ppi  cpi
                    gridIndex: 0,
                    type: 'value',
                    splitLine: {
                        show: false
                    },

                },

                { //pmi 利润亏损
                    gridIndex: 1,
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        formatter: (value, index) => {
                            if (value > 60 || value < -20) return ""
                            else return value
                        }
                    },
                    max: 70,
                    min: -35
                },

                { //hs300
                    gridIndex: 2,
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    position: "right",
                    min: 500
                },
                { //平均股债
                    gridIndex: 3,
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    inverse: true,
                    axisLabel: {
                        formatter: (value, index) => {
                            if (value >= 7) return ""
                            else return value
                        }
                    },
                     max: 8.5,
                     min: 0
                },
                { //中位股债
                    gridIndex: 4,
                    type: 'value',
                    splitLine: {
                        show: false
                    },

                },



                { //M1 M1-M2 
                    gridIndex: 5,
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    interval: 10,
                    axisLabel: {
                        formatter: (value, index) => {
                            if (value > 30) return ""
                            else return value
                        },
                        color: "black"
                    },
                    max: 35
                },
                { // 信贷
                    gridIndex: 5,
                    type: 'value',
                    splitLine: {
                        show: false
                    },
                    axisLabel: {
                        formatter: (value, index) => {
                            if (value >= 40) return ""
                            else return value
                        }
                    },
                    max: 40,
                    min: 20,
                    position: "right"
                },



            ],

            series: [
                {
                    name: "ppi",
                    type: "line",
                    xAxisIndex: 0,
                    yAxisIndex: 0,
                    showSymbol: false,
                    lineStyle: {
                        width: 1.5,
                    },
                    itemStyle: {
                        normal: {
                            color: {
                                type: "linear",
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [{
                                    offset: 0.95,
                                    color: "#0079cd"//"#0081B6",
                                },

                                {
                                    offset: 0.25,
                                    color: "#FD4142"//"#FD4142",
                                },
                                ],
                                globalCoord: true,
                            },
                        },
                    },
                    markLine: {
                        symbol: ["none", "none"],
                        data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "#ff535c",
                            },
                            label: {
                                formatter: "上下穿5",
                                color: "#ff535c",
                                fontSize: 10,
                                position: "insideStartTop",
                            },
                            yAxis: 5, // 标线值
                        },

                        {
                            lineStyle: {
                                width: 0.5,
                                color: "black",
                            },
                            label: {
                                formatter: "0",
                                color: "#0081B6",
                                fontSize: 10,
                                position: "insideStartBottom",
                            },
                            yAxis: 0, // 标线值
                        },
                        ],
                    },
                    tooltip: {
                        show: true,
                    },
                    data: PPI,
                },

                {
                    name: 'pmi',
                    type: 'line',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 0,
                    },
                    itemStyle: {
                        normal: {
                            areaStyle: {
                                color: "#8de372",
                            },
                        },
                        emphasis: {
                            areaStyle: {
                                color: "#8de372",
                            },
                        },
                    },

                    data: cn_pmi_平均.map(v => {
                        v[1] = parseFloat(v[1]) * 10
                        return v
                    }),

                },

                {
                    name: '红利$蓝亏',
                    type: 'line',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 1.5,
                        color: "#FD4142", //"#fd76c8"
                    },
                    data: 利润同比
                },
                {
                    name: '红利$蓝亏',
                    type: 'line',
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 1.5,
                        color: "#0081B6", //"#007c71",
                    },
                    data: 亏损增减
                },


                {
                    name: "300指数", //沪深300D
                    type: "line",
                    lineStyle: {
                        width: 0,
                    },
                    itemStyle: {
                        normal: {
                            areaStyle: {
                                color: "#87c5cf" // "#57aacb",
                            },
                        },
                        emphasis: {
                            areaStyle: {
                                color: "#87c5cf",
                            },
                        },
                    },
                    showSymbol: false,
                    xAxisIndex: 2,
                    yAxisIndex: 2,
                    data: 沪深300_xueqiu_day.map((item) => {
                        let tmp = []
                        tmp[0] = item.date
                        tmp[1] = item.close ? item.close : ""
                        return tmp
                    }),

                },
                {
                    name: "300股债差", //300平均股债差M
                    type: "line",
                    xAxisIndex: 3,
                    yAxisIndex: 3,
                    data: 股债差300平均.filter((item) => {
                        return parseFloat(item[0].substring(0, 4)) >= 2008;
                    }),
                    showSymbol: false,
                    lineStyle: {
                        width: 1.7,
                    },
                    itemStyle: {
                        normal: {
                            color: {
                                type: "linear",
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [{
                                    offset: 0.4,
                                    color: "red",
                                },
                                {
                                    offset: 0.6,
                                    color: "orange",
                                },

                                {
                                    offset: 0.8,
                                    color: "green",
                                },
                                ],
                                globalCoord: true,
                            },
                        },
                    },
                    markLine: {
                        symbol: ["none", "none"],
                        data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "green",
                            },
                            label: {
                                formatter: "6低估",
                                fontSize: "10",
                                color: "green",
                                position: "start",
                            },
                            yAxis: 6, // 标线值
                            x: "6.5%", //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 0.5,
                                color: "red",
                            },
                            label: {
                                formatter: "3高估",
                                fontSize: "10",
                                color: "red",
                                position: "start",
                            },
                            yAxis: 3, // 标线值
                            x: "6.5%",
                        },

                            // {
                            //     lineStyle: {
                            //         width: 0,
                            //         color: "#ff000000",
                            //         type: "solid" // 实线，不写默认虚线
                            //     },

                            //     yAxis: 0, // 标线值

                            // },
                        ],
                    },

                },
          
        

                
                {
                    name: "中位PE_十年倒数", //300剔除后中位
                    type: "line",
                    xAxisIndex: 4,
                    yAxisIndex: 4,
                    data: 沪深300PE中位数,
                    smooth: true,
                    showSymbol: false,
                    lineStyle: {
                        width: 1.5,
                        color: "#a45db2",
                    },
                    markLine: {
                        symbol: ["none", "none"],
                        data: [{
                            lineStyle: {
                                width: 0,
                                color: "#ff535c",
                            },
                            label: {
                                position: "start",
                                formatter: "30高估",
                                fontSize: "10",
                                color: "#ff535c",
                            },
                            yAxis: 30,
                            x: "7%", //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 1,
                                color: "green",
                            },
                            label: {
                                position: "start",
                                formatter: "20低估",
                                fontSize: "10",
                                color: "green",
                            },
                            yAxis: 20,
                            x: "7%", //固定起点的 x 像素位置
                        },
                        ],
                    },
                },
                {
                    name: "中位PE_十年倒数", //全a剔除后中位
                    type: "line",
                    xAxisIndex: 4,
                    yAxisIndex: 4,
                    data: 全A股PE中位数,
                    smooth: true,
                    showSymbol: false,
                    lineStyle: {
                        width: 1.5,
                        color: "#ff814f",
                    },
                },
                {
                    name: "中位PE_十年倒数", //十年前国债收益率倒数
                    type: "line",
                    xAxisIndex: 4,
                    yAxisIndex: 4,
                    data: 十年期国债利率倒数,
                    smooth: true,
                    showSymbol: false,
                    lineStyle: {
                        width: 1.7,
                        color: "black",
                    },
                },

                {
                    name: "300同比",
                    type: "line",
                    xAxisIndex: 4,
                    yAxisIndex: 4,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 1.7,
                    },
                    tooltip: {
                        show: false,
                    },
                    itemStyle: {
                        normal: {
                            color: {
                                type: "linear",
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [
                                    {
                                        offset: 0.45, //大 下
                                        color: "red",
                                    },
                                    {
                                        offset: 0.6,
                                        color: "orange",
                                    },

                                    {
                                        offset: 0.8, //小 上
                                        color: "green",
                                    },
                                ],
                                globalCoord: true,
                            },
                        },
                    },
                    markLine: {
                        symbol: ["none", "none"],
                        data: [
                            {
                                lineStyle: {
                                    width: 0.5,
                                    color: "green",
                                },
                                label: {
                                    formatter: "-20低估",
                                    color: "green",
                                    fontSize: "10",
                                    position: "start",
                                },
                                yAxis: -20, // 标线值
                                x: "6.5%", //固定起点的 x 像素位置
                            },
                            {
                                lineStyle: {
                                    width: 0.5,
                                    color: "red",
                                },
                                label: {
                                    formatter: "30高估",
                                    color: "red",
                                    fontSize: "10",
                                    position: "start",
                                },
                                yAxis: 30, // 标线值
                                x: "6.5%",
                            },
                            {
                                lineStyle: {
                                    width: 0.5,
                                    color: "gray",
                                    //type: "solid" // 实线，不写默认虚线
                                },
                                label: {
                                    formatter: "30高估",
                                    color: "red",
                                    fontSize: "0",
                                    position: "start",
                                },
                                yAxis: 0, // 标线值
                            },
                        ],
                    },
                    // data: 沪深300_xueqiu_month.map((item) => {
                    //     let tmp = []
                    //     tmp[0] = item.date
                    //     tmp[1] = item.closeYoY ? item.closeYoY * 100 : ""
                    //     return tmp
                    // }).filter(item => {
                    //     return parseFloat(item[0].substring(0, 4)) >= 2008
                    // })
                    data: 沪深300同比.filter(item => {
                        return parseFloat(item[0].substring(0, 4)) >= 2008
                    })
                },


                {
                    name: "M1",
                    type: "line",
                    xAxisIndex: 5,
                    yAxisIndex: 5,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 1.3,
                        color: "black",//"#ff4900",

                    },
                    data: M1,
                },
                {
                    name: "M1_MA",
                    type: "line",
                    xAxisIndex: 5,
                    yAxisIndex: 5,
                    showSymbol: false,
                    smooth: true,
                    lineStyle: {
                        width: 1.2,
                        type: 'dotted',
                        color: "black" //"#ff5c5c",

                    },
                    data: M1_MA,
                },

                {
                    name: '信贷脉冲',
                    type: 'line',
                    xAxisIndex: 5,
                    yAxisIndex: 6,
                    smooth: true,
                    showSymbol: false,

                    "itemStyle": {
                        "color": {
                            "type": "linear",
                            "x": 0,
                            "y": 0,
                            "x2": 0,
                            "y2": 1,
                            "colorStops": [{
                                "offset": 0.7, //小上 大下
                                "color": "green"
                            },
                            {
                                "offset": 0.5,
                                "color": "orange"
                            },

                            {
                                "offset": 0.3,
                                "color": "red"
                            }

                            ],
                            "globalCoord": false
                        }

                    },
                    lineStyle: {
                        width: 1.5,
                    },
                    data: 信贷脉冲
                },
                {
                    name: '信贷脉冲_MA',
                    type: 'line',
                    xAxisIndex: 5,
                    yAxisIndex: 6,
                    smooth: true,
                    showSymbol: false,

                    "itemStyle": {
                        "color": {
                            "type": "linear",
                            "x": 0,
                            "y": 0,
                            "x2": 0,
                            "y2": 1,
                            "colorStops": [{
                                "offset": 0.7,
                                "color": "green"
                            },
                            {
                                "offset": 0.5,
                                "color": "orange"
                            },

                            {
                                "offset": 0.3,
                                "color": "red"
                            }

                            ],
                            "globalCoord": false
                        }

                    },
                    lineStyle: {
                        width: 1.5,
                        type: 'dotted',
                    },
                    data: 信贷脉冲_MA
                },




                // {
                //     name: "红利低波估",
                //     type: "line",
                //     xAxisIndex: 5,
                //     yAxisIndex: 5,
                //     showSymbol: false,
                //     smooth: true,
                //     lineStyle: {
                //         width: 1,
                //         color: "black"
                //     },
                //     data: 红利低波_csi_month.map((item) => {
                //         let tmp = []
                //         tmp[0] = item.date
                //         tmp[1] = item.closeYoY ? item.closeYoY * 100 : ""
                //         return tmp
                //     }).filter(item => {
                //         return parseFloat(item[0].substring(0, 4)) >= 2004
                //     })
                // },



                ///以下仅为了对齐时间
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 0,
                    yAxisIndex: 0,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 1,
                    yAxisIndex: 1,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 2,
                    yAxisIndex: 2,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 3,
                    yAxisIndex: 3,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 4,
                    yAxisIndex: 4,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
                {
                    name: "",
                    type: "line",
                    xAxisIndex: 5,
                    yAxisIndex: 5,
                    tooltip: false,
                    data: justForAlignmentTime,
                    showSymbol: false,
                    lineStyle: {
                        width: 0,
                        color: "black",
                    },
                },
            ]
        };

        if (option && typeof option === "object") {
            myChart.setOption(option);
        }
        window.addEventListener("resize", myChart.resize);

        myChart.on('legendselectchanged', function (params) {
            if (params.name.includes("同比")) { //初次点击显示 hs300&全A中位&十年倒数   hs300同比
                if (params.selected[params.name]) {
                    option.yAxis[4].max = 110
                    option.yAxis[4].min = -50
                    params.selected.中位PE_十年倒数 = false
                    option.legend.selected = params.selected
                    myChart.setOption(option)

                }
            }
            if (params.name == "中位PE_十年倒数") {
                if (params.selected.中位PE_十年倒数) {
                    option.yAxis[4].max = 70
                    option.yAxis[4].min = 15
                    for (let legendName in params.selected) {
                        if (legendName.includes("同比")) {
                            params.selected[legendName] = false
                        }
                    }
                    option.legend.selected = params.selected
                    myChart.setOption(option)
                } else {
                    option.yAxis[4].max = 110
                    option.yAxis[4].min = -50
                    params.selected.中位PE_十年倒数 = false
                    option.legend.selected = params.selected
                    myChart.setOption(option)
                }
            }
        })

        setTimeout(() => {
            myChart.dispatchAction({
                type: 'legendToggleSelect',
                name: "中位PE_十年倒数"
            });
            myChart.dispatchAction({
                type: 'legendToggleSelect',
                name: "pmi"
            });
            myChart.dispatchAction({
                type: 'legendToggleSelect',
                name: "M1_MA"
            });
            myChart.dispatchAction({
                type: 'legendToggleSelect',
                name: "信贷脉冲_MA"
            })
        }, "1")
    </script>
</body>

</html>