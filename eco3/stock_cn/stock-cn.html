<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%">

<head>
    <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
    <script type="text/javascript" src="data/ppi_profile.js"></script>
    <script type="text/javascript" src="data/M12_HS300.js"></script>
    <script type="text/javascript" src="data/usd_cnh.js"></script>
    <script type="text/javascript" src="data/bond10_middlePe.js"></script>
    <script type="text/javascript" src="data/guZhaiCha.js"></script>
    <script type="text/javascript" src="data/m2Total.js"></script>
    <script type="text/javascript" src="data/vxeem.js"></script>
    <script type="text/javascript" src="data/pos_fund.js"></script>
    <script type="text/javascript" src="data/stockTongBi.js"></script>
    <script type="text/javascript" src="data/ashares_congestion.js"></script>
    <script type="text/javascript" src="data/cn_cars.js"></script>
    <script type="text/javascript" src="data/cn_trade.js"></script>
    <script type="text/javascript" src="data/mm_manucycle.js"></script>


    <div id="container" style="height: 100%; width: 80%;"></div>
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.3.2/dist/echarts.min.js"></script>
    <script type="text/javascript">
    //仅为了对齐时间
    Array.prototype.addStartEnd = function(start, end) {
        let arr = this
        arr = start.concat(arr)
        end.forEach((item) => {
            arr.push(item)
        })
        return arr
    }
    let currentDay = new Date()
    currentDay = currentDay.getFullYear() + "-" + (currentDay.getMonth() + 1) + "-" + currentDay.getDate()
    let justForAlignmentTime = []
    for (var i = 0; i < yield_300PeMiddle.length; i++) { justForAlignmentTime[i] = Array.from(yield_300PeMiddle[i]) }
    justForAlignmentTime = justForAlignmentTime.addStartEnd([
        ["2000-01-28", ""]
    ], [
        [currentDay, " "]
    ]).map(item => {
        item[1] = ""
        return item
    })
    ////仅为了对齐时间


    //调整数据 为了显示方便 
    usd_cnh = usd_cnh.map(item => {
        item[1] = parseFloat(item[1]) - 5.5
        return item
    })

    mm_manucycle = mm_manucycle.filter(item => {
        return parseFloat(item[0].substring(0, 4)) >= 2000
    }).map((item) => {
        item[0] = item[0].substring(0, 8) + "28"
        item[1] = (parseFloat(item[1])*5).toFixed(2) 
        return item
    })
    ashares_congestion = ashares_congestion.map(item=>{
        item[1] = (item[1]+5).toFixed(2) 
        return item
    })




    var dom = document.getElementById('container');
    var myChart = echarts.init(dom, "red", {
        renderer: 'canvas',
        useDirtyRect: false
    });
    var app = {};
    var option;
    option = {
        title: {},
        tooltip: {
            trigger: 'axis',
            show: true,
            position: ['70%', '41%'],
            order: 'seriesDesc',
            axisPointer: {
                type: 'cross',
                show: false
            },
            backgroundColor: "white",
            formatter: function(params, ticket, callback) {
                return null;
                // seriesName : "股债差" ,  value : ['2017-02-28', 4.11]
                let nameList = ["ppi", "profile", "M1_M2", "离岸人民币", "沪深300", "300中位PE", "全A中位PE", "十年收益率倒数", "300平均股债差"]
                nameList = nameList.map(name => {
                    let reslt = ''
                    params.forEach(ele => {
                        if (ele.seriesName == name) {
                            if (ele.seriesName == "离岸人民币") {
                                let usd_cnh = ele.value[1] + 5.5
                                reslt += `<div style="line-height: 25px"> ${ele.seriesName} <span style="text-align: right; float:right;font-weight:bold;"> ${usd_cnh}  </span> </div>`
                            } else {
                                reslt += `<div style="line-height: 25px"> ${ele.seriesName} <span style="text-align: right; float:right;font-weight:bold;"> ${ele.value[1]}  </span> </div>`
                            }

                        }
                    });
                    return reslt
                }).join('')
                return nameList;
            }
        },
        legend: {
            left: "7%",
            top: "31%",
            orient: 'vertical',
            backgroundColor: "white"
        },
        axisPointer: {
            link: [{
                xAxisIndex: 'all'
            }],
            lineStyle: {
                color: "black"
            }
        },
        dataZoom: [{
                show: true,
                realtime: true,
                start: 0,
                end: 100,
                xAxisIndex: [0, 1, 2, 3, 4, 5],
                bottom: -10
            },
            {
                type: 'inside',
                realtime: true,
                start: 0,
                end: 100,
                xAxisIndex: [0, 1, 2, 3, 4, 5]
            }
        ],
        grid: [{
                left: 60,
                right: 80,
                top: "0%",
                height: '10%',
                show: true,
                backgroundColor: '#c1c4c3',
            },

            {
                left: 60,
                right: 80,
                top: "10.5%",
                height: '13%',
                show: true,
                backgroundColor: '#c1c4c3',
            },
            {
                left: 60,
                right: 80,
                top: "24%",
                height: '13%',
                show: true,
                backgroundColor: '#c1c4c3',
            },

            {
                left: 60,
                right: 80,
                top: "37.5%",
                height: '31%',
                show: true,
                backgroundColor: '#c1c4c3',
            },


            {
                left: 60,
                right: 80,
                top: "69%",
                height: '17%',
                show: true,
                backgroundColor: '#c1c4c3',
            },

            {
                left: 60,
                right: 80,
                top: "86.5%",
                height: '12%',
                show: true,
                backgroundColor: '#c1c4c3',
            },
        ],
        xAxis: [{
                gridIndex: 0,
                type: "time",
                splitNumber: 20,
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    show: false
                },
                axisPointer: {
                    show: true,
                    label: {
                        show: false
                    }
                }
            },

            {
                gridIndex: 1,
                type: "time",
                splitNumber: 20,
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    show: false
                },
                axisPointer: {
                    show: true,
                    label: {
                        show: false
                    }
                }
            },

            {
                gridIndex: 2,
                type: "time",
                splitNumber: 20,
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    show: false
                },
                axisPointer: {
                    show: true,
                    label: {
                        show: false
                    }
                }
            },

            {
                gridIndex: 3,
                type: "time",
                splitNumber: 20,
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    show: false
                },
                axisPointer: {
                    show: true,
                    label: {
                        show: false
                    }
                }
            },


            {
                gridIndex: 4,
                type: "time",
                splitNumber: 20,
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    show: false
                },
                axisPointer: {
                    show: true,
                    label: {
                        show: false
                    }
                }
            },

            {
                gridIndex: 5,
                type: "time",
                splitNumber: 20,
                axisLabel: {
                    fontSize: 10,
                    formatter: "{yyyy}",
                    padding: [-7, -20, 0, 0],
                },
                splitLine: {
                    show: true,
                    lineStyle: {
                        color: ['#aaa']
                    }
                },
                axisLabel: {
                    fontSize: 10,
                    formatter: "{yyyy}",
                    padding: [-7, -20, 0, 0], // [上, 右, 下, 左] 
                },
            },
        ],
        yAxis: [{
                gridIndex: 0,
                type: 'value',
                splitLine: {
                    show: false
                },
            },
            {
                gridIndex: 0,
                type: 'value',
                splitLine: {
                    show: false
                },
            },


            {
                gridIndex: 1,
                type: 'value',
                splitLine: {
                    show: false
                },
                max: 100,
                min: -40,

            },
            {
                gridIndex: 1,
                type: 'value',
                splitLine: {
                    show: false
                },
                position: "right",
            },


            {
                gridIndex: 2,
                type: 'value',
                splitLine: {
                    show: false
                },
                axisLabel: {
                    formatter: (value, index) => {
                        if ((value + 5.5) < 6) return ""
                        else return value + 5.5
                    }
                },
                interval: 0.5,
                position: "right",
            },
            {
                gridIndex: 2,
                type: 'value',
                splitLine: {
                    show: false
                },

            },

            {
                gridIndex: 3,
                type: 'value',
                splitLine: {
                    show: false
                },
                min: 1500
            },
            {
                gridIndex: 3,
                type: 'value',
                splitLine: {
                    show: false
                },
                interval: 10,
                max: 90,
                min: -20
            },


            {
                gridIndex: 4,
                type: 'value',
                splitLine: {
                    show: false
                },
                axisLabel: {
                    formatter: (value, index) => {
                        if (value > 60 || value <= 0) return ""
                        else return value
                    }
                },
                interval: 10,
                position: "right",
                max:65,
                min:10
            },
            {
                gridIndex: 4,
                type: 'value',
                splitLine: {
                    show: false
                },
            },


            {
                gridIndex: 5,
                type: 'value',
                splitLine: {
                    show: false
                },
                position: "right",
            },
            {
                gridIndex: 5,
                type: 'value',
                splitLine: {
                    show: false
                },
            },
        ],
        series: [

            {
                name: 'ppi',
                type: 'line',
                xAxisIndex: 0,
                yAxisIndex: 0,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 1.5,
                },
                itemStyle: {
                    normal: {
                        color: {
                            "type": "linear",
                            "x": 0,
                            "y": 0,
                            "x2": 0,
                            "y2": 1,
                            "colorStops": [{
                                    "offset": 1,
                                    "color": "#0081B6"
                                },

                                {
                                    "offset": 0.1,
                                    "color": '#FD4142'
                                }
                            ],
                            "globalCoord": true
                        }
                    },
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 1,
                                color: "#ff535c",
                            },
                            label: {
                                formatter: "上穿5",
                                color: "#ff535c",
                                fontSize: 10,
                                position: 'insideStartTop',
                            },
                            yAxis: 5, // 标线值
                        },

                        {
                            lineStyle: {
                                width: 1,
                                color: "black",
                            },
                            label: {
                                formatter: "下穿0",
                                color: "#0081B6",
                                fontSize: 10,
                                position: 'insideStartBottom',
                            },
                            yAxis: 0, // 标线值  
                        },
                    ],
                },
                tooltip: {
                    show: true
                },
                data: ppi,
            },
            {
                name: 'mm_manucycle', //mm 制造业循环 美欧台
                type: 'line',
                xAxisIndex: 0,
                yAxisIndex: 0,
                data: mm_manucycle,
                showSymbol: false,
                lineStyle: {
                    width: 1,
                    color: "yellow"
                },
            },

            {
                name: 'profile',
                type: 'line',
                xAxisIndex: 1,
                yAxisIndex: 2,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 1.5,
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 1,
                                color: "#ff535c",
                            },
                            label: {
                                formatter: "上穿30",
                                color: "#ff535c",
                                fontSize: 10,
                                position: 'insideStartTop',
                            },
                            yAxis: 30,
                        },
                        {
                            lineStyle: {
                                width: 1,
                                color: "black",
                            },
                            label: {
                                formatter: "下穿0",
                                color: "#0081B6",
                                fontSize: 10,
                                position: 'insideStartBottom',
                            },
                            yAxis: 0,
                        },
                    ],
                },
                itemStyle: {
                    normal: {
                        color: {
                            "type": "linear",
                            "x": 0,
                            "y": 0,
                            "x2": 0,
                            "y2": 1,
                            "colorStops": [{
                                    "offset": 1,
                                    "color": "#0081B6"
                                },
                                {
                                    "offset": 0.6,
                                    "color": '#FD4142'
                                }
                            ],
                            "globalCoord": true
                        }
                    },
                },
                tooltip: {
                    show: true
                },
                data: profile,
            },
            // {
            //     name: 'cn_trade',
            //     type: 'line',
            //     xAxisIndex: 1,
            //     yAxisIndex: 2,
            //     data: [],//cn_trade,
            //     showSymbol: false,
            //     lineStyle: {
            //         width: 1,
            //         color:"#3f037a"
            //     },
            // },// [profile = cn_trade ] 

            {
                name: 'cn_cars',
                type: 'line',
                xAxisIndex: 1,
                yAxisIndex: 2,
                data: cn_cars,
                showSymbol: false,
                lineStyle: {
                    width: 1,
                    color:"yellow"
                },
            },



            {
                name: 'M1_M2', //主要看方向
                type: 'line',
                xAxisIndex: 2,
                yAxisIndex: 5,
                data: M1_M2,
                showSymbol: false,
                lineStyle: {
                    width: 1.5,
                    color: "#4764bd"
                },
            },
            {
                name: '离岸人民币', //主要看方向离岸香港美元
                type: 'line',
                xAxisIndex: 2,
                yAxisIndex: 4,
                data: usd_cnh,
                showSymbol: false,
                lineStyle: {
                    width: 1,
                    color: "gray"
                },
            },


            {
                name: '沪深300',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 6,
                data: HS300,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    //color: "black" #825ea5 #fdc375
                },
                itemStyle: {
                    normal: {
                        areaStyle: {
                            //color: "#fdc375"
                        },
                    },
                    emphasis: {
                        areaStyle: {
                            //color: "#fdc375"
                        },
                    }
                }
            },
            {
                name: '沪深300M2',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 6,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 0.5,
                    color: "black"
                },
                tooltip: {
                    show: false
                },
                data: M2zheSuan,
            },
            {
                name: '沪深300M2',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 6,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 0.5,
                    color: "black"
                },
                tooltip: {
                    show: false
                },
                data: M2zheSuan250
            },
            // {
            //     name: 'VXEEM',
            //     type: 'line',
            //     xAxisIndex: 3,
            //     yAxisIndex: 7,
            //     showSymbol: false,
            //     smooth: true,
            //     lineStyle: {
            //         width: 1,
            //         color: "white"
            //     },
            //     tooltip: {
            //         show: false
            //     },
            //     data: vxeem
            // },   
            {
                name: 'pos_fund',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 7,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 1.5,
                },
                tooltip: {
                    show: false
                },
                itemStyle: {
                    normal: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                    offset: 0,
                                    color: 'red'
                                },
                                {
                                    offset: 0.5,
                                    color: 'orange'
                                },

                                {
                                    offset: 1,
                                    color: 'green'
                                }
                            ],
                            globalCoord: true
                        }
                    },
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "green",
                            },
                            label: {
                                formatter: "65低估",
                                color: "green",
                                fontSize: "9",
                                position: 'start',
                            },
                            yAxis: 65, // 标线值
                            x: '73.5%' //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 0.5,
                                color: "red",
                            },
                            label: {
                                formatter: "85高估",
                                fontSize: "9",
                                color: "red",
                                position: 'start',
                            },
                            yAxis: 85, // 标线值
                            x: '73.5%'
                        },
                    ],
                },
                data: pos_fund
            },
            {
                name: 'ashares_congestion',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 7,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 1,
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "green",
                            },
                            label: {
                                formatter: "40低估",
                                color: "green",
                                fontSize: "9",
                                position: 'start',
                            },
                            yAxis: 40, // 标线值
                            x: '70%' //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 0.5,
                                color: "red",
                            },
                            label: {
                                formatter: "55高估",
                                fontSize: "9",
                                color: "red",
                                position: 'start',
                            },
                            yAxis: 55, // 标线值
                            x: '70%'
                        },
                    ],
                },
                itemStyle: {
                    normal: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                    offset: 0,
                                    color: 'red'
                                },
                                {
                                    offset: 0.5,
                                    color: 'orange'
                                },

                                {
                                    offset: 1,
                                    color: 'green'
                                }
                            ],
                            globalCoord: true
                        }
                    },
                },
                data:ashares_congestion
            },
            {
                name: 'tongBi300',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 7,
                showSymbol: false,
                smooth: true,
                lineStyle: {
                    width: 1.5,
                    //color: "gray"
                },
                tooltip: {
                    show: false
                },
                itemStyle: {
                    normal: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                    offset: 0.45, //大 下
                                    color: 'red'
                                },
                                {
                                    offset: 0.6,
                                    color: 'orange'
                                },

                                {
                                    offset: 0.8, //小 上
                                    color: 'green'
                                }
                            ],
                            globalCoord: true
                        }
                    },
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "green",
                            },
                            label: {
                                formatter: "0低估",
                                color: "green",
                                fontSize: "10",
                                position: 'start',
                            },
                            yAxis: 0, // 标线值
                            x: '25%' //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 0.5,
                                color: "red",
                            },
                            label: {
                                formatter: "30高估",
                                color: "red",
                                fontSize: "10",
                                position: 'start',
                            },
                            yAxis: 30, // 标线值
                            x: '25%'
                        },
                    ],
                },
                data: tongBi300
            },  
            // {
            //     name: '股GDP比',
            //     type: 'line',
            //     xAxisIndex: 3,
            //     yAxisIndex: 7,
            //     data: [],
            //     showSymbol: false,
            //     lineStyle: {
            //         width: 2,
            //     },
            // },


            {
                name: '300中位PE', //300剔除后中位
                type: 'line',
                xAxisIndex: 4,
                yAxisIndex: 8,
                data: yield_300PeMiddle,
                showSymbol: false,
                lineStyle: {
                    width: 1.5,
                    color: "#a45db2"
                },
            },
            {
                name: '全A中位PE', //全a剔除后中位
                type: 'line',
                xAxisIndex: 4,
                yAxisIndex: 8,
                data: yield_APeMiddle,
                showSymbol: false,
                lineStyle: {
                    width: 1.5,
                    color: "#ff814f"
                },
            },
            {
                name: '十年收益率倒数',
                type: 'line',
                xAxisIndex: 4,
                yAxisIndex: 8,
                data: yield_TenNaDeb,
                showSymbol: false,
                lineStyle: {
                    width: 1.5,
                    color: "black"
                },
            },

            {
                name: '300平均股债差', //300全平均pe - 10年国债 
                type: 'line',
                xAxisIndex: 5,
                yAxisIndex: 10,
                data: guZhaiCha,
                showSymbol: false,
                lineStyle: {
                    width: 1.5,
                },
                itemStyle: {
                    normal: {
                        color: {
                            type: 'linear',
                            x: 0,
                            y: 0,
                            x2: 0,
                            y2: 1,
                            colorStops: [{
                                    offset: 0.2,
                                    color: 'green'
                                },
                                {
                                    offset: 0.45,
                                    color: 'orange'
                                },

                                {
                                    offset: 1,
                                    color: 'red'
                                }
                            ],
                            globalCoord: true
                        }
                    },
                },
                markLine: {
                    symbol: ["none", "none"],
                    data: [{
                            lineStyle: {
                                width: 0.5,
                                color: "green",
                            },
                            label: {
                                formatter: "6低估",
                                fontSize: "10",
                                color: "green",
                                position: 'start',
                            },
                            yAxis: 6, // 标线值
                            x: '25%' //固定起点的 x 像素位置
                        },
                        {
                            lineStyle: {
                                width: 0.5,
                                color: "red",
                            },
                            label: {
                                formatter: "3高估",
                                fontSize: "10",
                                color: "red",
                                position: 'start',
                            },
                            yAxis: 3, // 标线值
                            x: '25%'
                        },
                    ],
                },
            },


            ///以下仅为了对齐时间
            {
                name: '',
                type: 'line',
                xAxisIndex: 0,
                yAxisIndex: 0,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    color: "black"
                },
            },
            {
                name: '',
                type: 'line',
                xAxisIndex: 1,
                yAxisIndex: 2,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 2,
                    color: "black"
                },
            },
            {
                name: '',
                type: 'line',
                xAxisIndex: 2,
                yAxisIndex: 5,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    color: "black"
                },
            },
            {
                name: '',
                type: 'line',
                xAxisIndex: 3,
                yAxisIndex: 6,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    color: "black"
                },
            },
            {
                name: '',
                type: 'line',
                xAxisIndex: 4,
                yAxisIndex: 8,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    color: "black"
                },
            },
            {
                name: '',
                type: 'line',
                xAxisIndex: 5,
                yAxisIndex: 10,
                tooltip: false,
                data: justForAlignmentTime,
                showSymbol: false,
                lineStyle: {
                    width: 0,
                    color: "black"
                },
            },
        ]
    }
    if (option && typeof option === 'object') {
        myChart.setOption(option);
    }
    window.addEventListener('resize', myChart.resize);
    </script>
</body>

</html>